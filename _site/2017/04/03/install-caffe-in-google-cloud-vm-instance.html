<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" /> <!--[if lte IE 9]><meta http-equiv="refresh" content="0;url=/ie.html"><![endif]--> <meta name="author" content="Ark.Tech.AI"> <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600|Droid+Sans+Mono' rel='stylesheet' type='text/css'> <link rel="shortcut icon" href="" /> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="http://localhost:4000/2017/04/03/install-caffe-in-google-cloud-vm-instance.html"> <!-- Begin Jekyll SEO tag v2.1.0 --> <title>Install caffe in Google Cloud vm instance - Ark.Tech.AI blog</title> <meta property="og:title" content="Install caffe in Google Cloud vm instance" /> <meta name="description" content="General dependencies sudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libhdf5-serial-dev protobuf-compiler sudo apt-get install libgflags-dev libgoogle-glog-dev liblmdb-dev sudo apt-get install --no-install-recommends libboost-all-dev other suggested packages sudo apt-get install build-essential sudo apt-get install vim cmake git sudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libboost-all-dev libhdf5-serial-dev glog wget https://google-glog.googlecode.com/files/glog-0.3.3.tar.gz tar zxvf glog-0.3.3.tar.gz cd glog-0.3.3 ./configure make &amp;&amp; make install gflags wget https://github.com/schuhschuh/gflags/archive/master.zip unzip master.zip cd gflags-master mkdir build &amp;&amp; cd build export CXXFLAGS=&quot;-fPIC&quot; &amp;&amp; cmake .. &amp;&amp; make VERBOSE=1 make &amp;&amp; make install lmdb git clone git://gitorious.org/mdb/mdb.git cd mdb/libraries/liblmdb make &amp;&amp; make install CUDA: Install by apt-get or the NVIDIA .run package. The NVIDIA package tends to follow more recent library and driver versions, but the installation is more manual. If installing from packages, install the library and latest driver separately; the driver bundled with the library is usually out-of-date. This can be skipped for CPU-only installation. Go to CUDA download, select the right OS, architecture, distribution, version, installer type. Download the installer (2.6 KB). sudo dpkg -i cuda-repo-ubuntu1404_8.0.61-1_amd64.deb sudo apt-get update sudo apt-get install cuda sudo reboot BLAS: Install ATLAS by sudo apt-get install libatlas-base-dev or install OpenBLAS or MKL for better CPU performance. cuDNN First, download cuDNN tar -zxvf cudnn-6.5-linux-x64-v2.tgz cd cudnn-6.5-linux-x64-v2 sudo cp lib* /usr/local/cuda/lib64/ sudo cp cudnn.h /usr/local/cuda/include/ Then update the soft link cd /usr/local/cuda/lib64/ sudo rm -rf libcudnn.so libcudnn.so.6.5 sudo ln -s libcudnn.so.6.5.48 libcudnn.so.6.5 sudo ln -s libcudnn.so.6.5 libcudnn.so setup enviroment parameters open file /etc/profile and add following at the end of the file PATH=/usr/local/cuda/bin:$PATH export PATH run following command to enable it source /etc/profile Meanwhile, add lib path, in folder /etc/ld.so.conf.d/, add new file cuda.conf with content: /usr/local/cuda/lib64 and run by sudo ldconfig install Intel MKL or Atlas sudo apt-get install libatlas-base-dev install OpenCV Recommend to install version 2.4.10. git clone https://github.com/bearpaw/Install-OpenCV.git cd Install-OpenCV/Ubuntu/2.4 sudo ./opencv2_4_10.sh Compilation Caffe can be compiled with either Make or CMake. Make is officially supported while CMake is supported by the community. Compilation with Make Configure the build by copying and modifying the example Makefile.config for your setup. The defaults should work, but uncomment the relevant lines if using Anaconda Python. cp Makefile.config.example Makefile.config # Adjust Makefile.config (for example, if using Anaconda Python, or if cuDNN is desired) make all -j 4 make test -j 4 make runtest -j 4 make pycaffe -j 4 References 01 Install Caffe in Ubuntu 14.04 from Scratch" /> <meta property="og:description" content="General dependencies sudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libhdf5-serial-dev protobuf-compiler sudo apt-get install libgflags-dev libgoogle-glog-dev liblmdb-dev sudo apt-get install --no-install-recommends libboost-all-dev other suggested packages sudo apt-get install build-essential sudo apt-get install vim cmake git sudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libboost-all-dev libhdf5-serial-dev glog wget https://google-glog.googlecode.com/files/glog-0.3.3.tar.gz tar zxvf glog-0.3.3.tar.gz cd glog-0.3.3 ./configure make &amp;&amp; make install gflags wget https://github.com/schuhschuh/gflags/archive/master.zip unzip master.zip cd gflags-master mkdir build &amp;&amp; cd build export CXXFLAGS=&quot;-fPIC&quot; &amp;&amp; cmake .. &amp;&amp; make VERBOSE=1 make &amp;&amp; make install lmdb git clone git://gitorious.org/mdb/mdb.git cd mdb/libraries/liblmdb make &amp;&amp; make install CUDA: Install by apt-get or the NVIDIA .run package. The NVIDIA package tends to follow more recent library and driver versions, but the installation is more manual. If installing from packages, install the library and latest driver separately; the driver bundled with the library is usually out-of-date. This can be skipped for CPU-only installation. Go to CUDA download, select the right OS, architecture, distribution, version, installer type. Download the installer (2.6 KB). sudo dpkg -i cuda-repo-ubuntu1404_8.0.61-1_amd64.deb sudo apt-get update sudo apt-get install cuda sudo reboot BLAS: Install ATLAS by sudo apt-get install libatlas-base-dev or install OpenBLAS or MKL for better CPU performance. cuDNN First, download cuDNN tar -zxvf cudnn-6.5-linux-x64-v2.tgz cd cudnn-6.5-linux-x64-v2 sudo cp lib* /usr/local/cuda/lib64/ sudo cp cudnn.h /usr/local/cuda/include/ Then update the soft link cd /usr/local/cuda/lib64/ sudo rm -rf libcudnn.so libcudnn.so.6.5 sudo ln -s libcudnn.so.6.5.48 libcudnn.so.6.5 sudo ln -s libcudnn.so.6.5 libcudnn.so setup enviroment parameters open file /etc/profile and add following at the end of the file PATH=/usr/local/cuda/bin:$PATH export PATH run following command to enable it source /etc/profile Meanwhile, add lib path, in folder /etc/ld.so.conf.d/, add new file cuda.conf with content: /usr/local/cuda/lib64 and run by sudo ldconfig install Intel MKL or Atlas sudo apt-get install libatlas-base-dev install OpenCV Recommend to install version 2.4.10. git clone https://github.com/bearpaw/Install-OpenCV.git cd Install-OpenCV/Ubuntu/2.4 sudo ./opencv2_4_10.sh Compilation Caffe can be compiled with either Make or CMake. Make is officially supported while CMake is supported by the community. Compilation with Make Configure the build by copying and modifying the example Makefile.config for your setup. The defaults should work, but uncomment the relevant lines if using Anaconda Python. cp Makefile.config.example Makefile.config # Adjust Makefile.config (for example, if using Anaconda Python, or if cuDNN is desired) make all -j 4 make test -j 4 make runtest -j 4 make pycaffe -j 4 References 01 Install Caffe in Ubuntu 14.04 from Scratch" /> <link rel="canonical" href="http://localhost:4000/2017/04/03/install-caffe-in-google-cloud-vm-instance.html" /> <meta property="og:url" content="http://localhost:4000/2017/04/03/install-caffe-in-google-cloud-vm-instance.html" /> <meta property="og:site_name" content="Ark.Tech.AI blog" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2017-04-03T00:00:00-05:00" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@Ark.Tech.AI" /> <script type="application/ld+json"> {"@context": "http://schema.org", "@type": "BlogPosting", "headline": "Install caffe in Google Cloud vm instance", "datePublished": "2017-04-03T00:00:00-05:00", "description": "General dependencies sudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libhdf5-serial-dev protobuf-compiler sudo apt-get install libgflags-dev libgoogle-glog-dev liblmdb-dev sudo apt-get install --no-install-recommends libboost-all-dev other suggested packages sudo apt-get install build-essential sudo apt-get install vim cmake git sudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libboost-all-dev libhdf5-serial-dev glog wget https://google-glog.googlecode.com/files/glog-0.3.3.tar.gz tar zxvf glog-0.3.3.tar.gz cd glog-0.3.3 ./configure make &amp;&amp; make install gflags wget https://github.com/schuhschuh/gflags/archive/master.zip unzip master.zip cd gflags-master mkdir build &amp;&amp; cd build export CXXFLAGS=&quot;-fPIC&quot; &amp;&amp; cmake .. &amp;&amp; make VERBOSE=1 make &amp;&amp; make install lmdb git clone git://gitorious.org/mdb/mdb.git cd mdb/libraries/liblmdb make &amp;&amp; make install CUDA: Install by apt-get or the NVIDIA .run package. The NVIDIA package tends to follow more recent library and driver versions, but the installation is more manual. If installing from packages, install the library and latest driver separately; the driver bundled with the library is usually out-of-date. This can be skipped for CPU-only installation. Go to CUDA download, select the right OS, architecture, distribution, version, installer type. Download the installer (2.6 KB). sudo dpkg -i cuda-repo-ubuntu1404_8.0.61-1_amd64.deb sudo apt-get update sudo apt-get install cuda sudo reboot BLAS: Install ATLAS by sudo apt-get install libatlas-base-dev or install OpenBLAS or MKL for better CPU performance. cuDNN First, download cuDNN tar -zxvf cudnn-6.5-linux-x64-v2.tgz cd cudnn-6.5-linux-x64-v2 sudo cp lib* /usr/local/cuda/lib64/ sudo cp cudnn.h /usr/local/cuda/include/ Then update the soft link cd /usr/local/cuda/lib64/ sudo rm -rf libcudnn.so libcudnn.so.6.5 sudo ln -s libcudnn.so.6.5.48 libcudnn.so.6.5 sudo ln -s libcudnn.so.6.5 libcudnn.so setup enviroment parameters open file /etc/profile and add following at the end of the file PATH=/usr/local/cuda/bin:$PATH export PATH run following command to enable it source /etc/profile Meanwhile, add lib path, in folder /etc/ld.so.conf.d/, add new file cuda.conf with content: /usr/local/cuda/lib64 and run by sudo ldconfig install Intel MKL or Atlas sudo apt-get install libatlas-base-dev install OpenCV Recommend to install version 2.4.10. git clone https://github.com/bearpaw/Install-OpenCV.git cd Install-OpenCV/Ubuntu/2.4 sudo ./opencv2_4_10.sh Compilation Caffe can be compiled with either Make or CMake. Make is officially supported while CMake is supported by the community. Compilation with Make Configure the build by copying and modifying the example Makefile.config for your setup. The defaults should work, but uncomment the relevant lines if using Anaconda Python. cp Makefile.config.example Makefile.config # Adjust Makefile.config (for example, if using Anaconda Python, or if cuDNN is desired) make all -j 4 make test -j 4 make runtest -j 4 make pycaffe -j 4 References 01 Install Caffe in Ubuntu 14.04 from Scratch", "url": "http://localhost:4000/2017/04/03/install-caffe-in-google-cloud-vm-instance.html"}</script> <!-- End Jekyll SEO tag --> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Ark.Tech.AI blog" /> <script src="/assets/js/prefixfree.js"></script> </head> <body> <aside id="sidebar" class="open"> <div id="sidebar-left"> <a id="sidebar-avatar" href="/"> <img id="sidebar-avatar-img" alt="" src="avatar.jpg"/> </a> <div id="sidebar-social"> <a href="/pages/feed.xml" class="sidebar-social-icon feed"></a> <a href="mailto:Ark.Tech.AI@gmail.com" class="sidebar-social-icon email"></a> <!-- Generate icon by yourself https://icomoon.io/app/#/select --> <a href="https://twitter.com/ark-tech-ai" class="sidebar-social-icon twitter" target="_blank"></a> <a href="https://github.com/ark-tech-ai" class="sidebar-social-icon github" target="_blank"></a> </div> <ul id="sidebar-tags"> <li class="sidebar-tag active" data-filter="recent">最新文章</li> </ul> </div> <div id="sidebar-right"> <div id="search-box"> <input id="search-input" type="text" placeholder="Search" /> </div> <nav id="toc"> <a class="toc-link" data-tags="" href="/2017/04/03/install-caffe-in-google-cloud-vm-instance.html"> Install caffe in Google Cloud vm instance </a> </nav> </div> </aside> <main id="main" class="open"> <article class="post container"> <div class="post-meta"> <span class="post-meta-span date">2017 April 03</span> </div> <h1 class="post-title">Install caffe in Google Cloud vm instance</h1> <h3 id="general-dependencies">General dependencies</h3> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>sudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libhdf5-serial-dev protobuf-compiler
sudo apt-get install libgflags-dev libgoogle-glog-dev liblmdb-dev
sudo apt-get install --no-install-recommends libboost-all-dev
</code></pre></div> <p>other suggested packages</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>sudo apt-get install build-essential
sudo apt-get install vim cmake git
sudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libboost-all-dev libhdf5-serial-dev
</code></pre></div> <p>glog</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>wget https://google-glog.googlecode.com/files/glog-0.3.3.tar.gz
tar zxvf glog-0.3.3.tar.gz
<span class="nb">cd </span>glog-0.3.3
./configure
make <span class="o">&amp;&amp;</span> make install
</code></pre></div> <p>gflags</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>wget https://github.com/schuhschuh/gflags/archive/master.zip
unzip master.zip
<span class="nb">cd </span>gflags-master
mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd </span>build
<span class="nb">export </span><span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s2">"-fPIC"</span> <span class="o">&amp;&amp;</span> cmake .. <span class="o">&amp;&amp;</span> make <span class="nv">VERBOSE</span><span class="o">=</span>1
make <span class="o">&amp;&amp;</span> make install
</code></pre></div> <p>lmdb</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>git clone git://gitorious.org/mdb/mdb.git
<span class="nb">cd </span>mdb/libraries/liblmdb
make <span class="o">&amp;&amp;</span> make install
</code></pre></div> <h3 id="cuda">CUDA:</h3> <p>Install by apt-get or the NVIDIA .run package. The NVIDIA package tends to follow more recent library and driver versions, but the installation is more manual. If installing from packages, install the library and latest driver separately; the driver bundled with the library is usually out-of-date. This can be skipped for CPU-only installation.</p> <p>Go to <a href="https://developer.nvidia.com/cuda-downloads">CUDA download</a>, select the right OS, architecture, distribution, version, installer type. Download the installer (2.6 KB).</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>sudo dpkg -i cuda-repo-ubuntu1404_8.0.61-1_amd64.deb
sudo apt-get update
sudo apt-get install cuda
sudo reboot
</code></pre></div> <h3 id="blas">BLAS:</h3> <p>Install ATLAS by</p> <div class="highlighter-rouge"><pre class="highlight"><code>sudo apt-get install libatlas-base-dev 
</code></pre></div> <p>or install OpenBLAS or MKL for better CPU performance.</p> <h3 id="cudnn">cuDNN</h3> <p>First, download cuDNN</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>tar -zxvf cudnn-6.5-linux-x64-v2.tgz
<span class="nb">cd </span>cudnn-6.5-linux-x64-v2
sudo cp lib<span class="k">*</span> /usr/local/cuda/lib64/
sudo cp cudnn.h /usr/local/cuda/include/
</code></pre></div> <p>Then update the soft link</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="nb">cd</span> /usr/local/cuda/lib64/
sudo rm -rf libcudnn.so libcudnn.so.6.5
sudo ln -s libcudnn.so.6.5.48 libcudnn.so.6.5
sudo ln -s libcudnn.so.6.5 libcudnn.so
</code></pre></div> <h3 id="setup-enviroment-parameters">setup enviroment parameters</h3> <p>open file /etc/profile and add following at the end of the file</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="nv">PATH</span><span class="o">=</span>/usr/local/cuda/bin:<span class="nv">$PATH</span>
<span class="nb">export </span>PATH
</code></pre></div> <p>run following command to enable it</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="nb">source</span> /etc/profile
</code></pre></div> <p>Meanwhile, add lib path, in folder /etc/ld.so.conf.d/, add new file cuda.conf with content:</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>/usr/local/cuda/lib64
</code></pre></div> <p>and run by</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>sudo ldconfig
</code></pre></div> <h3 id="install-intel-mkl-or-atlas">install Intel MKL or Atlas</h3> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>sudo apt-get install libatlas-base-dev
</code></pre></div> <h3 id="install-opencv">install OpenCV</h3> <p>Recommend to install version 2.4.10.</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>git clone https://github.com/bearpaw/Install-OpenCV.git
<span class="nb">cd </span>Install-OpenCV/Ubuntu/2.4
sudo ./opencv2_4_10.sh
</code></pre></div> <h3 id="compilation">Compilation</h3> <p>Caffe can be compiled with either Make or CMake. Make is officially supported while CMake is supported by the community.</p> <h4 id="compilation-with-make">Compilation with Make</h4> <p>Configure the build by copying and modifying the example Makefile.config for your setup. The defaults should work, but uncomment the relevant lines if using Anaconda Python.</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>cp Makefile.config.example Makefile.config
<span class="c"># Adjust Makefile.config (for example, if using Anaconda Python, or if cuDNN is desired)</span>
make all -j 4
make <span class="nb">test</span> -j 4
make runtest -j 4
make pycaffe -j 4
</code></pre></div> <h3 id="references">References</h3> <p>01 <a href="coldmooon.github.io/2015/08/03/caffe_install/">Install Caffe in Ubuntu 14.04 from Scratch</a></p> </article> <div class="post-share"> <div class="container"> <a href="https://twitter.com/share?url=http://localhost:4000/2017/04/03/install-caffe-in-google-cloud-vm-instance.html&text=Install caffe in Google Cloud vm instance" target="_blank" class="post-share-icon twitter"></a> <a href="https://www.evernote.com/clip.action?url=http://localhost:4000/2017/04/03/install-caffe-in-google-cloud-vm-instance.html&title=Install caffe in Google Cloud vm instance" target="_blank" class="post-share-icon evernote"></a> <a href="http://service.weibo.com/share/share.php?url=http://localhost:4000/2017/04/03/install-caffe-in-google-cloud-vm-instance.html&title=Install caffe in Google Cloud vm instance" target="_blank" class="post-share-icon weibo"></a> </div> </div> <div class="comment container"> <div id="disqus_thread"> </div> </div> <div class="footer"> <div class="container"> <p class="footer-entry">All content is licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA</a></p> <p class="footer-entry">Buit with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and <a href="https://github.com/P233/3-Jekyll" target="_blank">3-Jekyll theme</a> • Hosted on <a href="https://pages.github.com/" target="_blank">Github</a></p> </div> </div> </main> <button id="menu" class="open"> <span id="menu-icons"></span> </button> <button id="post-toc-menu"> <span id="post-toc-menu-icons"></span> </button> <div id="post-toc"> <span id="post-toc-title">Table of Contents</span> <ul id="post-toc-ul"></ul> </div> <script src="/assets/js/jquery-2.1.3.min.js"></script> <script src="/assets/js/jquery.pjax.js"></script> <script src="/assets/js/nprogress.js"></script> <script src="/assets/js/main.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-98293718-1', 'https://ark-tech-ai.github.io'); ga('send', 'pageview'); </script> </body> </html>
